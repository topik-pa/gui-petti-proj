(()=>{"use strict";const t=()=>{const t=document.querySelector("header"),e=t.querySelector(".icon-menu"),a=t.querySelector("nav");e.addEventListener("click",(()=>{a.classList.toggle("show")}))},e=()=>{const t=document.getElementById("goto_top"),e="visible";window.addEventListener("scroll",function(t,e=300){let a;return(...r)=>{clearTimeout(a),a=setTimeout((()=>{t.apply(this,r)}),e)}}((function(){window.scrollY>=200?t.classList.add(e):t.classList.remove(e)}))),t.addEventListener("click",(()=>{window.scrollTo({top:0,behavior:"smooth"})}))},a=document.getElementById("dtable"),r=a.querySelector("#pagination"),n=a.querySelector("ul"),s=a.querySelector("thead"),o=s.querySelectorAll("input");let d;const l={url:"https://petti-proj.herokuapp.com/matches",limit:50,page:0,total:void 0,pages:void 0,start:void 0,end:void 0,filterReqDelay:600},i={filters:[],sorts:[],get(){let t="?";return t+=`page=${l.page}`,t+=`&limit=${l.limit}`,this.sorts.forEach((e=>{t+=`&sortby=${encodeURIComponent(e.sortBy)}`,t+=`&order=${e.order}`})),this.filters.forEach((e=>{t+=`&filterby=${encodeURIComponent(e.filterBy)}`,t+=`&filter=${encodeURIComponent(e.filter)}`})),t}};n.addEventListener("click",(async t=>{const e=+t.target.dataset.page;isNaN(e)||l.page===e||(l.page=e,await p())})),s.addEventListener("click",(async t=>{const e=t.target.dataset.path;if(!e)return;const a=t.target.dataset.order;t.target.dataset.order="asc"===a?"desc":"asc",i.sorts=i.sorts.filter((t=>t.sortBy!==e)),i.sorts.push({sortBy:e,order:t.target.dataset.order}),await p()}));const c=t=>{d=setTimeout((async()=>{const e=t.value,a=t.parentElement.dataset.path;i.filters=i.filters.filter((t=>t.filterBy!==a)),i.filters.push({filterBy:a,filter:e}),await p()}),l.filterReqDelay)};for(const t of o)t.addEventListener("input",(async t=>{d?(clearTimeout(d),c(t.target)):c(t.target)}));const p=async()=>{a.classList.add("loading"),await fetch(l.url+i.get()).then((t=>{if(!t.ok)throw Error(`Status: ${t.status}. ${t.statusText}`);return t.json()})).then((t=>{(t=>{const e=a.getElementsByTagName("tbody")[0];e.innerText="";for(const a of t){const t=document.createElement("tr");t.innerHTML=`\n      <td>${a.id}</td>\n      <td>${a.date}</td>\n      <td>${a.hours}</td>\n      <td>${a.score}</td>\n      <td>${a.favoriteWin?"W":"L"}</td>\n      <td class="p1">${a.player1.name}</td>\n      <td class="p2">${a.player2.name}</td>\n      <td class="p1">${a.player1.origRank}</td>\n      <td class="p2">${a.player2.origRank}</td>\n      <td class="p1">${a.player1.rangeRank}</td>      \n      <td class="p2">${a.player2.rangeRank}</td>\n      <td class="p1">${a.player1.odds.toFixed(2)}</td>\n      <td class="p2">${a.player2.odds.toFixed(2)}</td>\n      <td class="p1">${a.player1.rangeOdds}</td>\n      <td class="p1">${a.inv}</td>\n      <td class="p1">${a.correctScore}</td>\n      <td>${a.association}</td>\n      <td>${a.surface}</td>\n      <td><a title="${a.tournament.name}" href="${a.tournament.url}">${a.tournament.name}</a></td>\n      <td>${a.tournament.value}</td>\n      <td>${a.round}</td>\n      <td class="${a.dataOrigin}"><a href="https://www.tennisexplorer.com/match-detail/?id=${a.id}" target="_blank" rel="noopener noreferrer">match</a></td>\n      <td class="p1">${a.player1.stringId}</td>\n      <td class="p1">${a.player1.stringIdCount}</td>\n      <td class="p2">${a.player2.stringId}</td>\n      <td class="p2">${a.player2.stringIdCount}</td>\n      <td>${a.sid2?.value}</td>\n      <td>${a.sid2?.countW}</td>\n      <td>${a.sid2?.countL}</td>\n      <td>${a.sid2?.perc}</td>\n      <td class="${a.sid2?.result}"></td>\n     `,e.appendChild(t)}})(t.matches),l.total=t.total,l.pages=Math.ceil(l.total/l.limit),l.end=l.limit*(l.page+1),l.start=l.end-l.limit+1,l.end>l.total&&(l.end=l.total,l.start=l.limit*(l.pages-1)+1)})).catch((t=>{l.total=0,l.page=-1,l.pages=0,l.start=0,l.end=0,a.classList.add("error"),console.error(t)})).finally((()=>{r.querySelector("#total").innerText=l.total,r.querySelector("#start").innerText=l.start,r.querySelector("#end").innerText=l.end,r.querySelector("#page").innerText=l.page+1,r.querySelector("#pages").innerText=l.pages,(()=>{n.innerText="";for(let t=0;t<l.pages;t++){const e=document.createElement("li");e.innerText=t+1,e.setAttribute("data-page",t),t===l.page&&e.classList.add("active"),n.appendChild(e)}})(),a.classList.remove("loading")}))},u=async()=>{await p()};if(t(),e(),location.hash){const t=document.getElementById(location.hash.replace("#",""));t&&setTimeout((()=>{t.scrollIntoView({behavior:"smooth"})}),500)}document.querySelector("body#home")&&u(),document.querySelector("body#err404")&&(async()=>{})()})();